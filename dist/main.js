(()=>{"use strict";class e{constructor(e,t){this._validationConfig=e,this._formElement=t,this._buttonElement=t.querySelector(e.buttonSelector),this._inputsList=Array.from(t.querySelectorAll("input"))}_checkIsInputValid(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_showInputError(e){this._formElement.querySelector(`#${e.id}-error`).textContent=e.validationMessage,e.classList.add(this._validationConfig.inputErrorClass)}_hideInputError(e){this._formElement.querySelector(`#${e.id}-error`).textContent="",e.classList.remove(this._validationConfig.inputErrorClass)}_setEventListeners(){this._inputsList.forEach((e=>{e.addEventListener("input",(e=>{this._checkIsInputValid(e.currentTarget),this._toggleSubmitButton()}))}))}_toggleSubmitButton(){this._hasInvalidInput()?this._buttonElement.disabled=!0:this._buttonElement.disabled=!1}_hasInvalidInput(){return this._inputsList.some((e=>!e.validity.valid))}enableValidation(){this._setEventListeners(),this._toggleSubmitButton()}resetValidation(){this._toggleSubmitButton(),this._inputsList.forEach((e=>{this._hideInputError(e)}))}}const t={inputSelector:".popup__input",buttonSelector:".popup__save-button",errorSelector:".popup__input-error",inputErrorClass:"popup__input_type_error"};class n{constructor(e,t,{handleCardClick:n}){this._name=e.name,this._link=e.link,this._templateSelector=t,this._handleCardClick=n}_getElement(){return document.querySelector(this._templateSelector).content.querySelector(".elements__item").cloneNode(!0)}generateCard(){return this._element=this._getElement(),this._elementImage=this._element.querySelector(".elements__image"),this._buttonLike=this._element.querySelector(".elements__like-button"),this._elementImage.src=this._link,this._elementImage.alt=this._name,this._element.querySelector(".elements__title").textContent=this._name,this._setEventListeners(),this._element}_setEventListeners(){this._buttonLike.addEventListener("click",(()=>{this._handleLikeButton()})),this._element.querySelector(".elements__delete-button").addEventListener("click",(()=>{this._handleDeleteButton()})),this._elementImage.addEventListener("click",(()=>{this._handleCardClick()}))}_handleLikeButton(){this._buttonLike.classList.toggle("elements__like-button_active")}_handleDeleteButton(){this._element.remove(),this._element=null}}class s{constructor(e){this._element=document.querySelector(e),this._image=this._element.querySelector(".popup__image"),this._subtitle=this._element.querySelector(".popup__subtitle"),this._handleEscButtonBound=this._handleEscClose.bind(this)}open(){this._element.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscButtonBound)}close(){this._element.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscButtonBound)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._element.querySelector(".popup__close-button").addEventListener("click",(()=>{this.close()})),this._element.addEventListener("click",(e=>{e.target===e.currentTarget&&this.close()}))}}class r extends s{constructor(e,{handleSubmitForm:t}){super(e),this._handleSubmitForm=t,this.formElement=this._element.querySelector("form"),this._inputsList=Array.from(this.formElement.querySelectorAll("input"))}_getInputsValues(){return this._inputsList.map((e=>e.value))}setEventListeners(){super.setEventListeners(),this.formElement.addEventListener("submit",(e=>{this._handleSubmitForm(e)}))}close(){super.close(),this.formElement.reset()}}const i=document.querySelector(".page"),o=i.querySelector(".elements__list"),l=new class{constructor({items:e,renderer:t},n){this._initialArray=e,this._renderer=t,this._container=document.querySelector(n)}addItem(e){this._container.append(e)}renderItems(){this._initialArray.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const t=new n(e,"#place-card",{handleCardClick:()=>{E.open(e.link,e.name)}}).generateCard();l.addItem(t)}},".elements__list");l.renderItems();const a=new class{constructor({userNameSelector:e,userOccupationSelector:t}){this._name=document.querySelector(e),this._occupation=document.querySelector(t)}getUserInfo(){return{name:this._name.textContent,occupation:this._occupation.textContent}}setUserInfo(e,t){this._name.textContent=e,this._occupation.textContent=t}}({userNameSelector:".profile__name",userOccupationSelector:".profile__occupation"}),c=new r("#popup-edit",{handleSubmitForm:e=>{e.preventDefault();const t=c._getInputsValues();a.setUserInfo(t[0],t[1]),c.close()}});c.setEventListeners();const u=new e(t,c.formElement);u.enableValidation();const d=i.querySelector(".profile__edit-button"),p=c.formElement.querySelector("#profile-name-input"),_=c.formElement.querySelector("#profile-occupation-input");d.addEventListener("click",(()=>{const e=a.getUserInfo();p.value=e.name,_.value=e.occupation,u.resetValidation(),c.open()}));const m=new r("#popup-add-post",{handleSubmitForm:e=>{e.preventDefault();const t=m._getInputsValues(),s=function(e,t){return new n(e,"#place-card",{handleCardClick:()=>{E.open(e.link,e.name)}}).generateCard()}({name:t[0],link:t[1]});o.prepend(s),m.close()}});m.setEventListeners();const h=new e(t,m.formElement);h.enableValidation(),i.querySelector(".profile__add-button").addEventListener("click",(()=>{m.open(),m.formElement.reset(),h.resetValidation()}));const E=new class extends s{constructor(e){super(e)}open(e,t){super.open(),this._image.src=e,this._image.alt=t,this._subtitle.textContent=t}}("#popup-image");E.setEventListeners()})();